"0","alpha = 0.05"
"0","n_sims = 1000"
"0","p_vals = numeric(n_sims)"
"0",""
"0","sample_sizes = seq(5, 100)"
"0","sample_size_powers = numeric(length(sample_sizes))"
"0",""
"0","# The maximum x value in the simulation."
"0","# Use the maximum observed x-value in the data"
"0","max_x = max(birdhab$ls)"
"0",""
"0","for(j in 1:length(sample_sizes))"
"0","{"
"0","  # A sequence of equally-spaced x-values:"
"0","  x_vals = seq(0, max_x, length.out = sample_sizes[j])"
"0","  "
"0","  for(i in 1:n_sims)"
"0","  {"
"0","    fit_sim = linear_sim_fit("
"0","      x = x_vals,"
"0","      y_int = int_obs,"
"0","      slope = slope_obs,"
"0","      st_dev = sd_obs"
"0","    )"
"0","    p_vals[i] = summary(fit_sim)$coefficients[2, 'Pr(>|t|)']"
"0","  }"
"0","  sample_size_powers[j] = sum(p_vals < alpha) / n_sims"
"0","}"
"0",""
"0",""
"0","sim_sample_size = "
"0","  data.frame("
"0","    sample_size = sample_sizes,"
"0","    power       = sample_size_powers)"
