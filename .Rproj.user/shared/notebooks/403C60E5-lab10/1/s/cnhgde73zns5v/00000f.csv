"0","rm(list = ls())"
"0",""
"0","rope = read.csv(here(""data"", ""rope.csv""))"
"0","rope$rope.type = factor(rope$rope.type)"
"0",""
"0","n_obs = length(rope$rope.type)"
"0","n_groups = length(levels(rope$rope.type))"
"0",""
"0","ss_tot = sum((rope$p.cut - mean(rope$p.cut))^2)"
"0","df_tot = n_obs - 1"
"0",""
"0","agg_sum_sq_resids = aggregate("
"0","  x = rope$p.cut,"
"0","  by = list(rope$rope.type),"
"0","  FUN = function(x) (sum((x - mean(x))^2)))"
"0","ss_within = sum(agg_sum_sq_resids$x)"
"0","df_within = n_obs - n_groups"
"0",""
"0","ss_among = ss_tot - ss_within"
"0","df_among = n_groups - 1"
"0",""
"0","ms_within = ss_within / (n_obs - n_groups)"
"0","ms_among  =  ss_among / (n_groups - 1)"
"0",""
"0","f_ratio = ms_among / ms_within"
"0","f_pval = pf(f_ratio, df_among, df_within, lower.tail = FALSE)"
